<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste Integração Render</title>
</head>
<body>
    <h1>Contador de Cliques</h1>
    <p>Total no servidor: <strong id="valor">Carregando...</strong></p>
    <button onclick="enviarClique()">Adicionar +1</button>

    <script>
        // Mude para a URL que o Render te deu (sem a barra no final)
        const URL_API = "https://teste-api-3-yl36.onrender.com";

        // Função para buscar dados
        async function buscarStatus() {
            try {
                const response = await fetch(`${URL_API}/status`);
                
                // Se não for sucesso (200), não tenta ler como JSON
                if (!response.ok) throw new Error("API ainda está carregando...");

                const dados = await response.json();
                document.getElementById('valor').innerText = dados.cliques;
            } catch (err) {
                document.getElementById('valor').innerText = "Erro ao conectar.";
                console.error(err);
            }
        }

        // Função para enviar dados (POST com parâmetro)
        async function enviarClique() {
            try {
                const response = await fetch(`${URL_API}/atualizar`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ incremento: 1 }) // Enviando parâmetro JS
                });

                const resultado = await response.json();
                document.getElementById('valor').innerText = resultado.total;
            } catch (err) {
                alert("Erro ao enviar clique. A API pode estar dormindo.");
            }
        }

        // Inicia buscando o valor atual
        buscarStatus();
    </script>
</body>
</html>
